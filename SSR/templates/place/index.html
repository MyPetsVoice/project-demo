{% extends "base.html" %}

{% block title %}í”Œë ˆì´ìŠ¤ - MyPet's Voice{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/place.css') }}">
{% endblock %}

{% block content %}
<div class="place-container">
    <div class="place-header">
        <h2>ë°˜ë ¤ë™ë¬¼ ë™ë°˜ ê°€ëŠ¥ ì¥ì†Œ</h2>
        <p>ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ì¥ì†Œë“¤ì„ ì°¾ì•„ë³´ì„¸ìš”</p>
    </div>

    <div class="search-section">
        <div class="search-bar">
            <div class="search-input-wrapper">
                <i class="fas fa-search"></i>
                <input type="text" id="place-search" placeholder="ì§€ì—­, ì¹´í˜, ì‹ë‹¹, íœì…˜ ë“±ì„ ê²€ìƒ‰í•˜ì„¸ìš”">
                <button class="search-btn" id="search-btn">ê²€ìƒ‰</button>
            </div>
        </div>
        
        <div class="search-filters">
            <div class="filter-group">
                <label>ì§€ì—­</label>
                <select id="region-filter">
                    <option value="">ì „ì²´ ì§€ì—­</option>
                    <option value="seoul">ì„œìš¸</option>
                    <option value="gyeonggi">ê²½ê¸°</option>
                    <option value="incheon">ì¸ì²œ</option>
                    <option value="busan">ë¶€ì‚°</option>
                    <option value="daegu">ëŒ€êµ¬</option>
                    <option value="daejeon">ëŒ€ì „</option>
                    <option value="gwangju">ê´‘ì£¼</option>
                    <option value="ulsan">ìš¸ì‚°</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>ì¹´í…Œê³ ë¦¬</label>
                <select id="category-filter">
                    <option value="">ì „ì²´ ì¹´í…Œê³ ë¦¬</option>
                    <option value="cafe">ì¹´í˜</option>
                    <option value="restaurant">ìŒì‹ì </option>
                    <option value="park">ê³µì›</option>
                    <option value="accommodation">ìˆ™ë°•</option>
                    <option value="hospital">ë™ë¬¼ë³‘ì›</option>
                    <option value="grooming">ë¯¸ìš©ì‹¤</option>
                    <option value="shopping">ì‡¼í•‘</option>
                </select>
            </div>
            
            <div class="filter-group">
                <label>ë°˜ë ¤ë™ë¬¼</label>
                <select id="pet-filter">
                    <option value="">ì „ì²´</option>
                    <option value="dog">ê°•ì•„ì§€</option>
                    <option value="cat">ê³ ì–‘ì´</option>
                    <option value="small-pet">ì†Œë™ë¬¼</option>
                </select>
            </div>
            
            <button class="filter-reset" id="reset-filters">
                <i class="fas fa-undo"></i> ì´ˆê¸°í™”
            </button>
        </div>
    </div>

    <div class="content-layout">
        <!-- ì§€ë„ ì˜ì—­ -->
        <div class="map-section">
            <div id="map-container">
                <!-- TODO: ì‹¤ì œ ì§€ë„ API ì—°ë™ -->
                <div class="map-placeholder">
                    <i class="fas fa-map-marked-alt"></i>
                    <p>ì§€ë„ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</p>
                </div>
            </div>
            <div class="map-controls">
                <button class="map-control-btn" id="current-location">
                    <i class="fas fa-crosshairs"></i>
                    í˜„ì¬ ìœ„ì¹˜
                </button>
                <button class="map-control-btn" id="toggle-view">
                    <i class="fas fa-list"></i>
                    ëª©ë¡ ë³´ê¸°
                </button>
            </div>
        </div>

        <!-- ì¥ì†Œ ëª©ë¡ -->
        <div class="places-section">
            <div class="places-header">
                <h3>ê²€ìƒ‰ ê²°ê³¼ <span class="result-count">156</span>ê³³</h3>
                <div class="sort-options">
                    <select id="sort-select">
                        <option value="distance">ê±°ë¦¬ìˆœ</option>
                        <option value="rating">í‰ì ìˆœ</option>
                        <option value="reviews">ë¦¬ë·°ìˆœ</option>
                        <option value="recent">ìµœê·¼ ë“±ë¡ìˆœ</option>
                    </select>
                </div>
            </div>

            <div class="places-list" id="places-list">
                <!-- ìƒ˜í”Œ ì¥ì†Œ ë°ì´í„° -->
                <div class="place-card">
                    <div class="place-image">
                        <img src="https://via.placeholder.com/200x150/4ecdc4/ffffff?text=ì¹´í˜" alt="í«í”„ë Œë“¤ë¦¬ ì¹´í˜">
                        <div class="place-badge">
                            <span class="badge badge-cafe">ì¹´í˜</span>
                        </div>
                    </div>
                    <div class="place-info">
                        <h4 class="place-name">ëŒ•ëŒ•ì´ ì¹´í˜</h4>
                        <p class="place-address">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì‹ ì‚¬ë™ 123-45</p>
                        <div class="place-tags">
                            <span class="tag">ğŸ• ê°•ì•„ì§€ ë™ë°˜</span>
                            <span class="tag">ğŸ…¿ï¸ ì£¼ì°¨ ê°€ëŠ¥</span>
                            <span class="tag">ğŸ¡ ì‹¤ë‚´</span>
                        </div>
                        <div class="place-meta">
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.5</span>
                                <span class="review-count">(127)</span>
                            </div>
                            <div class="distance">850m</div>
                        </div>
                        <p class="place-description">ë°˜ë ¤ê²¬ê³¼ í•¨ê»˜ ì¦ê¸¸ ìˆ˜ ìˆëŠ” ì•„ëŠ‘í•œ ì¹´í˜. ê°•ì•„ì§€ ì „ìš© ë©”ë‰´ì™€ ë†€ì´ê³µê°„ì´ ìˆì–´ìš”.</p>
                    </div>
                    <div class="place-actions">
                        <button class="btn btn-outline btn-sm">
                            <i class="fas fa-directions"></i> ê¸¸ì°¾ê¸°
                        </button>
                        <button class="btn btn-primary btn-sm">
                            <i class="fas fa-phone"></i> ì „í™”
                        </button>
                    </div>
                </div>

                <div class="place-card">
                    <div class="place-image">
                        <img src="https://via.placeholder.com/200x150/e74c3c/ffffff?text=ì‹ë‹¹" alt="í«í”„ë Œë“¤ë¦¬ ì‹ë‹¹">
                        <div class="place-badge">
                            <span class="badge badge-restaurant">ìŒì‹ì </span>
                        </div>
                    </div>
                    <div class="place-info">
                        <h4 class="place-name">í« ê°€ë“  ë ˆìŠ¤í† ë‘</h4>
                        <p class="place-address">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ì²­ë‹´ë™ 67-89</p>
                        <div class="place-tags">
                            <span class="tag">ğŸ• ê°•ì•„ì§€ ë™ë°˜</span>
                            <span class="tag">ğŸ± ê³ ì–‘ì´ ë™ë°˜</span>
                            <span class="tag">ğŸŒ¿ ì•¼ì™¸ì„</span>
                        </div>
                        <div class="place-meta">
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.2</span>
                                <span class="review-count">(89)</span>
                            </div>
                            <div class="distance">1.2km</div>
                        </div>
                        <p class="place-description">ë„“ì€ ì•¼ì™¸ í…Œë¼ìŠ¤ì—ì„œ ë°˜ë ¤ë™ë¬¼ê³¼ í•¨ê»˜ ì‹ì‚¬í•  ìˆ˜ ìˆëŠ” ë ˆìŠ¤í† ë‘ì…ë‹ˆë‹¤.</p>
                    </div>
                    <div class="place-actions">
                        <button class="btn btn-outline btn-sm">
                            <i class="fas fa-directions"></i> ê¸¸ì°¾ê¸°
                        </button>
                        <button class="btn btn-primary btn-sm">
                            <i class="fas fa-phone"></i> ì „í™”
                        </button>
                    </div>
                </div>

                <div class="place-card">
                    <div class="place-image">
                        <img src="https://via.placeholder.com/200x150/2ecc71/ffffff?text=ê³µì›" alt="ë°˜ë ¤ë™ë¬¼ ê³µì›">
                        <div class="place-badge">
                            <span class="badge badge-park">ê³µì›</span>
                        </div>
                    </div>
                    <div class="place-info">
                        <h4 class="place-name">í•œê°•ê³µì› ëšì„¬ì§€êµ¬</h4>
                        <p class="place-address">ì„œìš¸ì‹œ ê´‘ì§„êµ¬ ìì–‘ë™ í•œê°•ê³µì›</p>
                        <div class="place-tags">
                            <span class="tag">ğŸ• ê°•ì•„ì§€ ë™ë°˜</span>
                            <span class="tag">ğŸš« ëª©ì¤„ í•„ìˆ˜</span>
                            <span class="tag">ğŸŒ³ ì•¼ì™¸</span>
                        </div>
                        <div class="place-meta">
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.7</span>
                                <span class="review-count">(234)</span>
                            </div>
                            <div class="distance">2.1km</div>
                        </div>
                        <p class="place-description">ë„“ì€ ì”ë””ë°­ê³¼ ì‚°ì±…ë¡œê°€ ìˆì–´ ë°˜ë ¤ê²¬ê³¼ ë›°ì–´ë†€ê¸° ì¢‹ì€ ê³µì›ì…ë‹ˆë‹¤.</p>
                    </div>
                    <div class="place-actions">
                        <button class="btn btn-outline btn-sm">
                            <i class="fas fa-directions"></i> ê¸¸ì°¾ê¸°
                        </button>
                        <button class="btn btn-primary btn-sm">
                            <i class="fas fa-info-circle"></i> ì •ë³´
                        </button>
                    </div>
                </div>

                <div class="place-card">
                    <div class="place-image">
                        <img src="https://via.placeholder.com/200x150/9b59b6/ffffff?text=ë³‘ì›" alt="ë™ë¬¼ë³‘ì›">
                        <div class="place-badge">
                            <span class="badge badge-hospital">ë³‘ì›</span>
                        </div>
                    </div>
                    <div class="place-info">
                        <h4 class="place-name">ì‚¬ë‘ ë™ë¬¼ë³‘ì›</h4>
                        <p class="place-address">ì„œìš¸ì‹œ ê°•ë‚¨êµ¬ ë…¼í˜„ë™ 45-12</p>
                        <div class="place-tags">
                            <span class="tag">ğŸ¥ 24ì‹œê°„ ì§„ë£Œ</span>
                            <span class="tag">ğŸš— ì£¼ì°¨ ê°€ëŠ¥</span>
                            <span class="tag">ğŸ’³ ì¹´ë“œ ê²°ì œ</span>
                        </div>
                        <div class="place-meta">
                            <div class="rating">
                                <i class="fas fa-star"></i>
                                <span>4.8</span>
                                <span class="review-count">(156)</span>
                            </div>
                            <div class="distance">950m</div>
                        </div>
                        <p class="place-description">ê²½í—˜ ë§ì€ ìˆ˜ì˜ì‚¬ì„ ìƒë‹˜ì´ ê³„ì‹œëŠ” ì‹ ë¢°í•  ìˆ˜ ìˆëŠ” ë™ë¬¼ë³‘ì›ì…ë‹ˆë‹¤.</p>
                    </div>
                    <div class="place-actions">
                        <button class="btn btn-outline btn-sm">
                            <i class="fas fa-directions"></i> ê¸¸ì°¾ê¸°
                        </button>
                        <button class="btn btn-primary btn-sm">
                            <i class="fas fa-phone"></i> ì „í™”
                        </button>
                    </div>
                </div>
            </div>

            <!-- í˜ì´ì§€ë„¤ì´ì…˜ -->
            <div class="pagination">
                <button class="page-btn" disabled>
                    <i class="fas fa-chevron-left"></i>
                </button>
                <button class="page-btn active">1</button>
                <button class="page-btn">2</button>
                <button class="page-btn">3</button>
                <span class="page-dots">...</span>
                <button class="page-btn">10</button>
                <button class="page-btn">
                    <i class="fas fa-chevron-right"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- ë¹ˆ ìƒíƒœ -->
    <div class="empty-state" style="display: none;">
        <div class="empty-icon">ğŸ—ºï¸</div>
        <h3>ê²€ìƒ‰ ê²°ê³¼ê°€ ì—†ì–´ìš”</h3>
        <p>ë‹¤ë¥¸ í‚¤ì›Œë“œë¡œ ê²€ìƒ‰í•´ë³´ì‹œê±°ë‚˜ í•„í„°ë¥¼ ì¡°ì •í•´ë³´ì„¸ìš”</p>
        <button class="btn btn-primary" onclick="document.getElementById('place-search').focus()">
            ë‹¤ì‹œ ê²€ìƒ‰í•˜ê¸°
        </button>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/place.js') }}"></script>
<script>
// ê²€ìƒ‰ ê¸°ëŠ¥
document.getElementById('search-btn').addEventListener('click', function() {
    const query = document.getElementById('place-search').value.trim();
    if (query) {
        searchPlaces(query);
    }
});

document.getElementById('place-search').addEventListener('keypress', function(e) {
    if (e.key === 'Enter') {
        const query = this.value.trim();
        if (query) {
            searchPlaces(query);
        }
    }
});

// í•„í„° ë³€ê²½ ì²˜ë¦¬
document.querySelectorAll('#region-filter, #category-filter, #pet-filter').forEach(select => {
    select.addEventListener('change', function() {
        applyFilters();
    });
});

// í•„í„° ì´ˆê¸°í™”
document.getElementById('reset-filters').addEventListener('click', function() {
    document.getElementById('region-filter').value = '';
    document.getElementById('category-filter').value = '';
    document.getElementById('pet-filter').value = '';
    document.getElementById('place-search').value = '';
    applyFilters();
});

// ì •ë ¬ ë³€ê²½
document.getElementById('sort-select').addEventListener('change', function() {
    const sortBy = this.value;
    sortPlaces(sortBy);
});

// í˜„ì¬ ìœ„ì¹˜ ë²„íŠ¼
document.getElementById('current-location').addEventListener('click', function() {
    if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(function(position) {
            const lat = position.coords.latitude;
            const lng = position.coords.longitude;
            // TODO: ì§€ë„ API ì—°ë™í•˜ì—¬ í˜„ì¬ ìœ„ì¹˜ë¡œ ì´ë™
            alert(`í˜„ì¬ ìœ„ì¹˜: ${lat.toFixed(6)}, ${lng.toFixed(6)}`);
        }, function(error) {
            alert('ìœ„ì¹˜ ì •ë³´ë¥¼ ê°€ì ¸ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.');
        });
    } else {
        alert('ì´ ë¸Œë¼ìš°ì €ëŠ” ìœ„ì¹˜ ì„œë¹„ìŠ¤ë¥¼ ì§€ì›í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤.');
    }
});

// ë·° í† ê¸€
document.getElementById('toggle-view').addEventListener('click', function() {
    const mapSection = document.querySelector('.map-section');
    const placesSection = document.querySelector('.places-section');
    
    if (mapSection.style.display === 'none') {
        mapSection.style.display = 'block';
        placesSection.style.flex = '1';
        this.innerHTML = '<i class="fas fa-list"></i> ëª©ë¡ ë³´ê¸°';
    } else {
        mapSection.style.display = 'none';
        placesSection.style.flex = 'none';
        placesSection.style.width = '100%';
        this.innerHTML = '<i class="fas fa-map"></i> ì§€ë„ ë³´ê¸°';
    }
});

// ê²€ìƒ‰ í•¨ìˆ˜
function searchPlaces(query) {
    // TODO: ì‹¤ì œ ê²€ìƒ‰ API í˜¸ì¶œ
    console.log('ê²€ìƒ‰ì–´:', query);
    // ì„ì‹œë¡œ ë¡œë”© í‘œì‹œ
    showLoading();
    setTimeout(() => {
        hideLoading();
        // ê²€ìƒ‰ ê²°ê³¼ ì—…ë°ì´íŠ¸
    }, 1000);
}

// í•„í„° ì ìš© í•¨ìˆ˜
function applyFilters() {
    const region = document.getElementById('region-filter').value;
    const category = document.getElementById('category-filter').value;
    const petType = document.getElementById('pet-filter').value;
    
    // TODO: í•„í„° ì ìš© ë¡œì§ êµ¬í˜„
    console.log('í•„í„°:', { region, category, petType });
}

// ì •ë ¬ í•¨ìˆ˜
function sortPlaces(sortBy) {
    // TODO: ì •ë ¬ ë¡œì§ êµ¬í˜„
    console.log('ì •ë ¬ ê¸°ì¤€:', sortBy);
}

// ë¡œë”© í‘œì‹œ/ìˆ¨ê¹€
function showLoading() {
    document.querySelector('.places-list').style.opacity = '0.5';
}

function hideLoading() {
    document.querySelector('.places-list').style.opacity = '1';
}

// ê¸¸ì°¾ê¸° ë²„íŠ¼ ì²˜ë¦¬
document.querySelectorAll('.place-actions .btn-outline').forEach(btn => {
    btn.addEventListener('click', function() {
        const placeCard = this.closest('.place-card');
        const placeName = placeCard.querySelector('.place-name').textContent;
        const address = placeCard.querySelector('.place-address').textContent;
        
        // TODO: ì‹¤ì œ ì§€ë„ ì•±ìœ¼ë¡œ ì—°ê²°
        alert(`${placeName}ìœ¼ë¡œ ê¸¸ì°¾ê¸°\nì£¼ì†Œ: ${address}`);
    });
});

// ì „í™” ë²„íŠ¼ ì²˜ë¦¬
document.querySelectorAll('.place-actions .btn-primary').forEach(btn => {
    btn.addEventListener('click', function() {
        const btnText = this.textContent.trim();
        if (btnText.includes('ì „í™”')) {
            // TODO: ì‹¤ì œ ì „í™”ë²ˆí˜¸ë¡œ ì—°ê²°
            alert('ì „í™” ì—°ê²° ê¸°ëŠ¥');
        } else if (btnText.includes('ì •ë³´')) {
            // TODO: ìƒì„¸ ì •ë³´ ëª¨ë‹¬ í‘œì‹œ
            alert('ìƒì„¸ ì •ë³´ í‘œì‹œ');
        }
    });
});
</script>
{% endblock %}